# 쿨라매기 매매법 알고리즘 완전 정량화 가이드

## 목표 설정
- 쿨라매기의 3가지 핵심 셋업(브레이크아웃, 에피소드 피벗, 파라볼릭)을 완전히 정량화
- 일봉 기준으로 모든 조건을 수치화하여 알고리즘 구현 가능하도록 설계
- 승률 25-35%, 손익비 1:10 이상을 목표로 하는 시스템 구축

---

## 1. 기초 스크리닝 조건 (모든 셋업 공통)

### 1.1 기본 필터링 조건
- **주가 범위**: 현재가 ≥ 5,000원
- **거래량 조건**: 일평균 거래량(20일) ≥ 500,000주
- **ADR 조건**: ADR ≥ 3.5% (계산: (High-Low)/Close의 20일 평균)
- **시가총액**: 중형주 이상 (300억원 이상 권장)

### 1.2 기본 상승 조건 (선택적 적용)
- **1개월 수익률**: ≥ 25%
- **3개월 수익률**: ≥ 50% 
- **6개월 수익률**: ≥ 100%
- **현재가 위치**: Close > 10일MA AND Close > 20일MA

---

## 2. 브레이크아웃 셋업 (Breakout Setup)

### 2.1 사전 조건 확인
- **초기 상승**: 지난 1-3개월간 30-100% 이상 상승
  - 계산: (현재가 - N일전 저점) / N일전 저점 ≥ 0.3 (N=20~60일)
- **현재 위치**: 52주 신고가 대비 70% 이상 수준 유지

### 2.2 VCP(Volatility Contraction Pattern) 패턴 정량화

#### VCP 패턴 인식 알고리즘
```
단계 1: 조정 단계별 변동성 측정
- 1차 조정: ADR1 = (High-Low)/Close의 첫 번째 조정 구간 평균
- 2차 조정: ADR2 = (High-Low)/Close의 두 번째 조정 구간 평균  
- 3차 조정: ADR3 = (High-Low)/Close의 세 번째 조정 구간 평균

단계 2: 수축 조건 확인
- ADR2 < ADR1 * 0.8 (20% 이상 수축)
- ADR3 < ADR2 * 0.8 (20% 이상 수축)
- 각 조정의 최대 하락폭이 점진적으로 감소

단계 3: 저점 상승 확인
- Low2 > Low1 (두 번째 조정 저점이 첫 번째보다 높음)
- Low3 > Low2 (세 번째 조정 저점이 두 번째보다 높음)

단계 4: 거래량 수축 확인
- Volume2 < Volume1 * 0.7 (30% 이상 감소)
- Volume3 < Volume2 * 0.7 (30% 이상 감소)
```

### 2.3 매수 시그널 조건
- **돌파 확인**: Close > 통합구간 고점 * 1.02
- **거래량 증가**: Volume > 20일 평균거래량 * 1.5
- **ADR 대비 위험**: (진입가 - 당일 저점) / 진입가 ≤ ADR * 0.67
- **이동평균 조건**: Close > 10일MA AND 10일MA > 20일MA

### 2.4 손절 및 익절 조건
- **손절**: Close < 매수일 저점 (캔들 종가 기준)
- **1차 익절**: 3-5일 후 포지션의 33-50% 매도
- **2차 익절**: Close < 10일MA (초보자) 또는 Close < 20일MA
- **손절가 조정**: 1차 익절 후 손절가를 진입가로 상향 조정

---

## 3. 에피소드 피벗 셋업 (Episode Pivot Setup)

### 3.1 사전 조건
- **기간 제한**: 최근 3-6개월간 과도한 상승(100% 이상) 없음
- **기준선 위치**: Close > 50일MA (중장기 추세 양호)
- **실적 예상**: 분기 실적 발표 전후 7일 이내

### 3.2 EP 시그널 조건 정량화
- **갭 상승**: 시초가 ≥ 전일 종가 * 1.1 (10% 이상 갭업)
- **거래량 폭증**: 당일 거래량 ≥ 평균 거래량(20일) * 3.0
- **장초반 거래량**: 시가 후 30분 내 거래량 ≥ 일평균의 50%
- **실적 서프라이즈**:
  - EPS 증가율 ≥ 100% (전년 동기 대비)
  - 매출 증가율 ≥ 20% (전년 동기 대비)
  - 실적 컨센서스 대비 ≥ 20% 상회

### 3.3 매수 및 관리 전략
- **매수 시점**: 갭업 후 첫 번째 정리 구간에서 매수
- **매수 조건**: 시초가 대비 -5% ~ +5% 범위 내
- **손절**: 갭업 전 고점 하회 시
- **익절**: 일반 브레이크아웃과 동일하게 단계별 실현

---

## 4. 파라볼릭 숏 셋업 (Parabolic Short Setup)

### 4.1 과열 조건 확인
- **단기 상승폭**:
  - 대형주: 5-10일간 50-100% 상승
  - 중소형주: 5-10일간 200-500% 상승
- **연속 상승**: 3일 이상 연속 양봉
- **거래량 급증**: 평균 거래량 대비 5배 이상 증가

### 4.2 숏 시그널 조건
- **기술적 조건**:
  - RSI(14) ≥ 80
  - 현재가 > 20일MA * 1.5 (50% 이상 괴리)
  - 3일 연속 상승 후 첫 번째 음봉 발생
- **매도 시점**: 고점 대비 -10% 이하 진입
- **손절**: 최근 고점 +5% 돌파 시
- **익절**: 20일MA 접근 시 또는 -30% 목표

---

## 5. 리스크 관리 시스템

### 5.1 포지션 사이징
- **계좌 대비 위험**: 단일 거래당 0.5-1.0% 위험
- **포지션 크기**: 전체 계좌의 10-20%
- **최대 보유**: 계좌의 30% 초과 금지 (하룻밤 보유 기준)

### 5.2 손익비 관리
- **목표 손익비**: 1:10 이상
- **승률 목표**: 25-35%
- **기대값**: (승률 × 평균익절) - (패율 × 평균손절) > 0

### 5.3 시장 환경별 조정
- **강세장**: 공격적 포지션 사이징 (위험 1.0-1.5%)
- **약세장**: 보수적 접근 (위험 0.25-0.5%)
- **횡보장**: 선별적 투자, EP 셋업 중심

---

## 6. 백테스팅 및 검증 기준

### 6.1 성과 측정 지표
- **승률**: 수익 거래 / 전체 거래
- **평균 손익비**: 평균 수익 / 평균 손실
- **최대 낙폭**: 연속 손실의 최대 크기
- **샤프 비율**: (수익률 - 무위험률) / 변동성

### 6.2 검증 기간 및 조건
- **백테스팅 기간**: 최소 3년 (강세장, 약세장, 횡보장 포함)
- **거래 빈도**: 월 평균 5-10회
- **시장 필터**: 코스피 200 지수 기준 시장 상황 분류

---

## 7. 실행 체크리스트

### 7.1 일일 스크리닝 프로세스
1. 기본 필터링 조건으로 1차 선별 (100-200종목)
2. VCP 패턴 및 각 셋업별 조건 확인 (10-30종목)
3. 관심종목 리스트 업데이트 및 알림 설정
4. 시장 환경 분석 및 포지션 사이징 결정

### 7.2 매수 실행 시
- [ ] 해당 셋업 조건 모두 충족 확인
- [ ] ADR 대비 손절 위험 계산
- [ ] 포지션 사이징 계산
- [ ] 손절가 및 익절 계획 수립

### 7.3 포지션 관리 시
- [ ] 일일 손절가 모니터링
- [ ] 단계별 익절 실행
- [ ] 손절가 상향 조정 (익절 후)
- [ ] 시장 환경 변화 대응

---

## 8. 주의사항 및 한계

### 8.1 시스템 한계
- 낮은 승률로 인한 심리적 부담
- 시장 환경에 따른 성과 편차
- 개별 종목 특성에 따른 조정 필요

### 8.2 위험 요소
- 연속 손실 발생 가능성
- 시장 급변 시 손절 지연 위험
- 유동성 부족 종목의 거래 위험

### 8.3 지속적 개선 방안
- 정기적인 백테스팅 및 파라미터 조정
- 시장 환경별 조건 세밀화
- 추가 필터링 조건 개발 및 적용

---

## 알고리즘 구현 우선순위

1. **1단계**: 기본 스크리닝 시스템 구축
2. **2단계**: VCP 패턴 인식 알고리즘 개발
3. **3단계**: 브레이크아웃 셋업 완성
4. **4단계**: EP 및 파라볼릭 셋업 추가
5. **5단계**: 백테스팅 및 최적화
6. **6단계**: 실전 적용 및 모니터링